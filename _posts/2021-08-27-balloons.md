---
layout: post
title: Popping balloons
date: 2021-08-27
published: false
---

<script type="text/javascript" src="http://cdn.mathjax.org/mathjax/latest/MathJax.js?config=TeX-AMS-MML_HTMLorMML"></script>

<div id="outline-container-org9058046" class="outline-2">
<h2 id="org9058046">Popping balloons risk assessment game</h2>
<div class="outline-text-2" id="text-org9058046">
<p>
Today I played an interesting game as part of a test at work. This
game was for testing my risk-aversity and risk-assesment skill. 
</p>

<p>
In the game, you are pumping balloons one at the time. There are at
any moment two options.
</p>

<ul class="org-ul">
<li>Cash in the balloon</li>
<li>Pump the balloon</li>
</ul>

<p>
If you cash in the balloon, the amount you gain is the number of time
the balloon was pumped. Then you get a new balloon to try on. If you
pump the balloon, it may pop, you get nothing and a new balloon
starts. If it doesn't pop, you can choose again with the same
balloon. You have a starting total of 30 balloons and the target is to
maximize your gains.
</p>

<p>
The risk comes from the fact that you don't know how many pumps the
balloon can take.
</p>
</div>

<div id="outline-container-orgba1351b" class="outline-3">
<h3 id="orgba1351b">Optimal strategy</h3>
<div class="outline-text-3" id="text-orgba1351b">
<p>
Can we come up with an optimal strategy for this game? The problem is
a bit like the <a href="https://en.wikipedia.org/wiki/Multi-armed_bandit">Multi-armed bandit problem</a>, perhaps even equivalent to
some form of it, but I am not an expert on the topic. In this post I
want to analyze a couple of strategies and assumptions of the pumping
balloon game.
</p>

<p>
What makes this problem really hard is the tradeoff between
exploration and getting as much out of the current balloon as
possible. In the game, it is probably worth sacrificing a couple of
balloons to learn about how many pumps they can take. But how many you
want to sacrifice will depend on the total number of balloons you can
spend. So first, let's calculate some numbers on the best strategy if
you have only one balloon. I will leave the analysis of the
exploration tradeoffs for some other time.
</p>

<p>
If you know the exact number of pumps a balloon can take, the optimal
strategy is easy, you just pump until one below its maximum. Let's
call the maximum pressure the balloon can take <code>M</code>. Now let's assume
you have some kind of idea of <code>M</code>, you don't know what it is, but you
have a "prior" belief about <code>M</code>. For example, you believe the maximum
pressure is not above 20, but any number below is equally likely.
</p>

<div class="org-src-container">
<pre class="src src-ess-julia"><span style="color: #b6a0ff;">using</span> Plots
<span style="color: #b6a0ff;">using</span> Distributions

belief = Uniform(0, 20)
bar(x -&gt; pdf(belief, x), -10:30, labels=<span style="color: #79a8ff;">"probability"</span>)
</pre>
</div>

<div id="org38aca52" class="figure">
<p><img src="/assets/images/uniformbelief.png" alt="uniformbelief.png" />
</p>
</div>

<p>
There is one situation in which you are absolutely sure you want to
cash in, if you have pumped it 20 times. If you are at 19, what is
your updated belief about \(M\)? You've discarded all the possibilities
\(M < 19\), and the other two cases are equally likely, so
</p>

<p>
\[
\mathbb{P}(M = 20) = \mathbb{P}(M = 19) = \frac{1}{2}
\]
</p>

<p>
Now the expected value of cashing in is exactly 19, and the expected
value of pumping is 10,
</p>

\begin{align}
\mathbb{E}(\text{pump}) = \mathbb{P}(M = 19) \cdot 0 + \mathbb{P}(M = 20) \cdot 20
= \frac{1}{2}\cdot 20 = 10
\end{align}

<p>
Let's do this calculation for 18. Your updated prior is that the
probability that it will break after one pump is \(\frac{1}{3}\). The
expected value of a pump is
</p>

<div class="org-src-container">
<pre class="src src-ess-julia">2 / 3 * 19
</pre>
</div>

<pre class="example">
12.666666666666666
</pre>


<p>
So still not worth it. Let's generalize a bit, if you have pumped \(i\)
times, there is a 1 in \(21 - i\) probability it will break on the next
try. Let's assume that after that try, it is not worth playing
on. Then the expected value of trying is \(\frac{20 - i}{21 - i}\cdot (i +
1)\), which you have to weigh against the immediate payoff of \(i\).
</p>

<div class="org-src-container">
<pre class="src src-ess-julia">scatter(i -&gt; (i + 1) * (20 - i) / (21 - i), 0:20, labels=<span style="color: #79a8ff;">"Pump"</span>)
scatter!(i -&gt; i, 0:20, labels=<span style="color: #79a8ff;">"Cash"</span>)
</pre>
</div>


<div id="orgc5ecb2f" class="figure">
<p><img src="/assets/images/uniformpumpvcash.png" alt="uniformpumpvcash.png" />
</p>
</div>

<p>
From the graph, you can see that the break-even occurs at 10 pumps, as
intuitively makes sense. 
</p>

<p>
.. To be continued ..
</p>

<ul class="org-ul">
<li>Poisson distribution</li>
<li>Markov decision process</li>
<li>Updating priors after a balloon</li>
</ul>
</div>
</div>
</div>
